#{extends 'CRUD/layout.html' /}

#{set 'moreScripts'}
<script src="@{'/public/javascripts/ndfitems.js'}" type="text/javascript"></script>
<script type="text/javascript">
	var businessDefaultValuesAction = #{jsAction @Businesss.getDefaultValues(':id') /}
	var defaultValuesForPlace = #{jsAction @NdfItems.getDefaultValuesForPlace(':place') /}
</script>
#{/set}

<div id="crudShow" class="${type.name}">
	
	<h2 id="crudShowTitle">&{'show.NdfItem', object.ndf.toString()}</h2>
	
	<div class="objectForm">
	#{form action: (object.id == null) ? @create() : @save(object.id), enctype:'multipart/form-data'}
		#{crud.form fields: ['ndf', 'itemDate', 'business', 'place', 'itemObject', 'trip', 'ndfItemTripPrice', 'km', 'ndfItemKmPrice']}
			#{crud.custom 'ndf'}
				<input type="hidden" name="object.ndf.id" value="${object.ndf.id}" />
				<input type="hidden" id="object_kmprice" name="object_kmprice" value="${object.ndf.km.price}" />
			#{/crud.custom}
			#{crud.custom 'itemDate'}
				#{crud.numberField name:'dayNumber', value:(object['dayNumber']) /}
				
				#{field 'object.itemDate'}
					#{ifError field.name}
						<span class="error">${field.error}</span>
					#{/ifError}
				#{/field}
				
			#{/crud.custom}
		#{/crud.form}
		<p class="crudButtons">
			<input type="submit" name="_save" value="&{'crud.save', type.modelName}" />
			#{if object.id == null}
				<input type="submit" name="_saveAndUpdateBusiness" value="&{'crud.saveAndUpdateBusiness', type.modelName}" />
			#{/if}
			<input type="button" name="_cancel" value="&{'crud.cancel'}" onclick="document.location = '@{Ndfs.show(object.ndf.id)}';" />
		</p>
	#{/form}
	</div>
	
</div>

